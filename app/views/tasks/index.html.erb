<h1>Les missions pour <%= @event.name %></h1>

<% @categories.each do |category| %>
  <h2><%= category.name %></h2>
  <ul>
    <% category.tasks.each do |task| %>
      <li>
        <%= task.name %> - Assigné à : <%= task.assigned_to ? "#{task.assigned_to.first_name} #{task.assigned_to.last_name}" : "Non assigné" %>
        <%= link_to 'Modifier', edit_event_task_path(@event, task), class: 'btn btn-warning' %>
        <%= link_to 'Supprimer', event_task_path(@event, task), method: :delete, data: { confirm: 'Es-tu sûr(e) ?' }, class: 'btn btn-danger' %>
      </li>
    <% end %>
  </ul>

  <!-- Render the form partial for each category -->
  <%= render 'form', task: Task.new, event: @event, category: category %>
<% end %>

<ul>
  <% @tasks_without_category.each do |task| %>
    <li>
      <%= task.name %> - Assigné à : <%= task.assigned_to ? "#{task.assigned_to.first_name} #{task.assigned_to.last_name}" : "Non assigné" %>
      <%= link_to 'Modifier', edit_event_task_path(@event, task), class: 'btn btn-warning' %>
      <%= link_to 'Supprimer', event_task_path(@event, task), method: :delete, data: { confirm: 'Es-tu sûr(e) ?' }, class: 'btn btn-danger' %>
    </li>
  <% end %>
</ul>

<!-- Render the form partial for tasks without category -->
<%= render 'form', task: Task.new, event: @event, category: nil %>
